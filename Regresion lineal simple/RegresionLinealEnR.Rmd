---
title: "Regresión lineal simple en R"
output: html_notebook
---

Ejemplos: [Regresión lineal simple en R](https://rpubs.com/JairoAyala/RLS)

## Ejercicios de práctica.

### 1. Calcular coeficientes B0 y B1.

Se tienen los siguientes datos de la velocidad **y** (en m/min) contra tiempo **x** (en min), alcanzada por un vehículo. **tiempo**: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63. **velocidad**: 6.074, 9.253, 2.12, 33.958, 17.091, 29.497, 40.736, 33.2, 55.984, 42.352, 68.059, 64.505, 73.928, 67.49, 69.881, 64.48, 77.521, 92.46, 112.457, 120.584, 86.776, 129.336, 127.974, 126.644, 142.142, 150.571, 158.793, 168.109, 155.273, 177.559, 162.845, 171.44, 163.068, 182.024, 177.544, 204.095, 211.844, 206.653, 228.487, 211.281, 216.282, 218.727, 232.403, 260.634, 232.477, 256.812, 261.978, 279.516, 286.449, 272.892, 271.768, 286.87, 287.542, 307.869, 304.418, 297.648, 302.478, 311.89, 314.993, 324.375, 348.374, 333.483, 354.513. Determina los coeficientes $\beta_0$ y $\beta_1$ del modelo de regresión $y = \beta_0 + \beta_1x + \epsilon$.

Nota: aproxima UNICAMENTE hasta el final a milésimas. Además, ingresa los valores sin necesidad de escribir los paréntesis, es decir, solo coloca: $\beta_0$, $\beta_1$.

#### Solución.

```{r}
x <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63)
y <- c(6.074, 9.253, 2.12, 33.958, 17.091, 29.497, 40.736, 33.2, 55.984, 42.352, 68.059, 64.505, 73.928, 67.49, 69.881, 64.48, 77.521, 92.46, 112.457, 120.584, 86.776, 129.336, 127.974, 126.644, 142.142, 150.571, 158.793, 168.109, 155.273, 177.559, 162.845, 171.44, 163.068, 182.024, 177.544, 204.095, 211.844, 206.653, 228.487, 211.281, 216.282, 218.727, 232.403, 260.634, 232.477, 256.812, 261.978, 279.516, 286.449, 272.892, 271.768, 286.87, 287.542, 307.869, 304.418, 297.648, 302.478, 311.89, 314.993, 324.375, 348.374, 333.483, 354.513)

reg <- lm(y~x)
reg
```

Como se puede observar de la salida anterior, los valores de los coeficientes $\beta_0$ ('intercept') y $\beta_1$ ('x') son *-3.567, 5.562* respectivamente.

### 2. Calcular intervalo de confianza para B1.

Se tienen los siguientes datos de la velocidad **y** (en m/min) contra tiempo **x** (en min), alcanzada por un vehículo. **tiempo**: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66. **velocidad**: 0.649, 0.534, 0.125, -1.284, -0.161, -1.106, -1.033, 0.888, 1.335, 0.177, 1.764, -1.298, 0.351, 0.497, 1.275, 1.176, 1.299, -0.202, -0.287, 1.43, -0.722, -2.55, -1.536, -0.449, -2.319, -1.658, -0.989, 0.319, 0.701, 0.688, 0.034, -0.415, -0.903, 5.873, 5.635, 5.051, 3.953, 5.209, 3.951, 4.025, 6.622, 6.174, 5.216, 6.323, 3.546, 5.507, 4.855, 6.276, 6.418, 6.502, 5.5, 4.803, 5.829, 5.022, 2.49, 3.922, 4.274, 3.117, 3.679, 4.02, 5.272, 5.252, 5.563, 5.501, 4.894, 3.835. Determina el intervalo del 96% de confianza para $\beta_1$ del modelo de regresión $y = \beta_0 + \beta_1x + \epsilon$.

Nota: aproxima UNICAMENTE hasta el final a milésimas. Además, ingresa los valores sin necesidad de escribir los paréntesis, es decir, solo coloca: Li,Ls.

#### Solución.

```{r}
x <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66)
y <- c(0.649, 0.534, 0.125, -1.284, -0.161, -1.106, -1.033, 0.888, 1.335, 0.177, 1.764, -1.298, 0.351, 0.497, 1.275, 1.176, 1.299, -0.202, -0.287, 1.43, -0.722, -2.55, -1.536, -0.449, -2.319, -1.658, -0.989, 0.319, 0.701, 0.688, 0.034, -0.415, -0.903, 5.873, 5.635, 5.051, 3.953, 5.209, 3.951, 4.025, 6.622, 6.174, 5.216, 6.323, 3.546, 5.507, 4.855, 6.276, 6.418, 6.502, 5.5, 4.803, 5.829, 5.022, 2.49, 3.922, 4.274, 3.117, 3.679, 4.02, 5.272, 5.252, 5.563, 5.501, 4.894, 3.835)
conf_level <- 0.96

reg <- lm(y~x)
confint(reg, level = conf_level)
```

De la salida anterior, con un nivel de confianza del 96% se puede observar que los intervalos de confianza (Li y Ls respectivamente) para $\beta_1$ ('x')  son:
```{r}
Li <- round(0.08399047, 3)
Ls <- round(0.1339345, 3)
print( c(Li,  Ls) )
```

### 3. Hacer predicción para **y** dado **x** mediante el uso del modelo de regresión.

Se tienen los siguientes datos de la velocidad **y** (en m/min) contra tiempo **x** (en min), alcanzada por un vehículo. **tiempo**: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54. **velocidad**: 0.462, 1.197, -1.27, -1.492, 1.244, 0.616, 0.225, 0.188, -0.576, -0.147, 0.038, -0.592, 1.191, -1.269, 0.528, -0.495, 0.944, 0.537, -1.132, 0.689, 0.467, 1.029, -0.015, -0.072, -1.053, -1.692, 0.166, 4.783, 6.482, 4.151, 3.704, 6.187, 5.673, 5.57, 4.806, 4.677, 4.79, 4.82, 3.794, 6.667, 3.272, 5.806, 4.111, 6.131, 5.695, 3.786, 5.647, 5.563, 5.89, 4.503, 5.373, 3.984, 3.209, 5.028. Determina el valor de la velocidad predicha para un valor de tiempo de 51 minutos, en el modelo de regresión $y = \beta_0 + \beta_1x + \epsilon$.

Nota: aproxima UNICAMENTE hasta el final a milésimas.

#### Solución.

```{r}
x <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54)
y <- c(0.462, 1.197, -1.27, -1.492, 1.244, 0.616, 0.225, 0.188, -0.576, -0.147, 0.038, -0.592, 1.191, -1.269, 0.528, -0.495, 0.944, 0.537, -1.132, 0.689, 0.467, 1.029, -0.015, -0.072, -1.053, -1.692, 0.166, 4.783, 6.482, 4.151, 3.704, 6.187, 5.673, 5.57, 4.806, 4.677, 4.79, 4.82, 3.794, 6.667, 3.272, 5.806, 4.111, 6.131, 5.695, 3.786, 5.647, 5.563, 5.89, 4.503, 5.373, 3.984, 3.209, 5.028)
minute <- 51

reg <- lm(y~x)
pred_minute <- data.frame(x = c(minute))
prediction <- predict(reg, pred_minute)

round(prediction, 3)
```

### 4. Intervalo de predicción en el modelo de regresión dado un valor para **x**.

Se tienen los siguientes datos de la velocidad **y** (en m/min) contra tiempo **x** (en min), alcanzada por un vehículo. **tiempo**: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43. **velocidad**: 25.83, 38.567, 46.132, 63.697, 67.592, 77.237, 85.128, 102.147, 98.607, 110.704, 122.47, 137.278, 135.157, 147.384, 152.647, 153.781, 177.25, 185.189, 191.785, 201.615, 214.096, 217.837, 228.856, 238.694, 237.629, 263.798, 278.6, 270.16, 285.419, 292.907, 303.428, 309.031, 315.353, 345.574, 336.981, 344.638, 351.741, 360.474, 372.951, 387.08, 397.193, 392.376, 414.993. Determina el intervalo del 96% de predicción en el modelo de regresión $y = \beta_0 + \beta_1x + \epsilon$, cuando $x=27$ minutos.

Nota: aproxima UNICAMENTE hasta el final a milésimas. Además, ingresa los valores sin necesidad de escribir los paréntesis, es decir, solo coloca: Li,Ls.

#### Solución.

```{r}
x <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43)
y <- c(25.83, 38.567, 46.132, 63.697, 67.592, 77.237, 85.128, 102.147, 98.607, 110.704, 122.47, 137.278, 135.157, 147.384, 152.647, 153.781, 177.25, 185.189, 191.785, 201.615, 214.096, 217.837, 228.856, 238.694, 237.629, 263.798, 278.6, 270.16, 285.419, 292.907, 303.428, 309.031, 315.353, 345.574, 336.981, 344.638, 351.741, 360.474, 372.951, 387.08, 397.193, 392.376, 414.993)
minute <- 27
conf_level <- 0.96

reg <- lm(y~x)
pred_minute <- data.frame(x = c(minute))
predict(reg, pred_minute, interval = "prediction", level = conf_level)
```

De la salida anterior, podemos ver que los intervalos de predicción Li (lwr) y Ls (upr) son:
```{r}
Li <- round(253.8398, 3)
Ls <- round(277.6481, 3)
print( c(Li, Ls) )
```

## Ejercicios de evaluación (diferentes a los de práctica).

### 2. Calcular intervalo de confianza para B0.

Se tienen los siguientes datos de la velocidad **y** (en m/min) contra tiempo **x** (en min), alcanzada por un vehículo. **tiempo**: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69. **velocidad**: 20.597, 26.601, 33.615, 40.481, 47.668, 52.851, 58.912, 65.692, 74.677, 78.473, 86.439, 91.538, 99.951, 104.822, 111.605, 117.233, 124.331, 131.205, 136.886, 143.251, 150, 156.301, 162.695, 170.583, 175.79, 183.135, 189.022, 196.052, 202.139, 208.619, 214.707, 221.269, 228.457, 234.884, 240.753, 247.456, 255.602, 260.072, 267.341, 273.05, 279.632, 286.613, 292.487, 299.072, 305.804, 312.028, 319.162, 325.064, 332.183, 338.719, 344.539, 350.911, 358, 364.465, 370.864, 376.903, 383.848, 390.266, 397.774, 403.243, 409.691, 416.63, 422.477, 428.794, 435.374, 442.724, 448.627, 455.828, 461.378. Determina el intervalo del 84% de confianza para $\beta_0$ del modelo de regresión $y = \beta_0 + \beta_1x + \epsilon$.

Nota: aproxima UNICAMENTE hasta el final a milésimas. Además, ingresa los valores sin necesidad de escribir los paréntesis, es decir, solo coloca: Li,Ls.

#### Solución.

```{r}
x <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69)
y <- c(20.597, 26.601, 33.615, 40.481, 47.668, 52.851, 58.912, 65.692, 74.677, 78.473, 86.439, 91.538, 99.951, 104.822, 111.605, 117.233, 124.331, 131.205, 136.886, 143.251, 150, 156.301, 162.695, 170.583, 175.79, 183.135, 189.022, 196.052, 202.139, 208.619, 214.707, 221.269, 228.457, 234.884, 240.753, 247.456, 255.602, 260.072, 267.341, 273.05, 279.632, 286.613, 292.487, 299.072, 305.804, 312.028, 319.162, 325.064, 332.183, 338.719, 344.539, 350.911, 358, 364.465, 370.864, 376.903, 383.848, 390.266, 397.774, 403.243, 409.691, 416.63, 422.477, 428.794, 435.374, 442.724, 448.627, 455.828, 461.378)
conf_level <- 0.84

reg <- lm(y~x)
confint(reg, level = conf_level)
```

De la salida anterior, con un nivel de confianza del 84% se puede observar que los intervalos de confianza (Li y Ls respectivamente) para $\beta_0$ ('14.387141')  son:
```{r}
Li <- round(13.998200, 3)
Ls <- round(14.387141, 3)
print( c(Li,  Ls) )
```

### 5. Intervalo de confianza para la respuesta media en el modelo de regresión dado un valor para **x**.

Se tienen los siguientes datos de la velocidad **y** (en m/min) contra tiempo **x** (en min), alcanzada por un vehículo. **tiempo**: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61. **velocidad**: 25.403, 29.034, 34.274, 39.194, 44.398, 49.314, 54.448, 59.2, 64.416, 69.744, 74.641, 80.43, 84.752, 89.612, 94.551, 99.927, 104.85, 112.441, 114.736, 119.802, 125.378, 130.19, 134.967, 140.483, 146.101, 150.861, 155.644, 160.639, 165.242, 170.605, 176.419, 180.442, 185.435, 190.824, 195.799, 200.992, 205.773, 211.098, 216.583, 221.156, 226.895, 230.96, 236.199, 241.545, 246.336, 251.149, 256.838, 261.754, 267.196, 271.366, 277.262, 281.589, 287.122, 291.878, 296.62, 301.97, 307.207, 312.031, 317.035, 321.799, 327.503. Determina el intervalo del 89% de confianza para la velocidad media, cuando $x = 47$ minutos.

Nota: aproxima UNICAMENTE hasta el final a milésimas. Además, ingresa los valores sin necesidad de escribir los paréntesis, es decir, solo coloca: Li,Ls.

#### Solución.

```{r}
x <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61)
y <- c(25.403, 29.034, 34.274, 39.194, 44.398, 49.314, 54.448, 59.2, 64.416, 69.744, 74.641, 80.43, 84.752, 89.612, 94.551, 99.927, 104.85, 112.441, 114.736, 119.802, 125.378, 130.19, 134.967, 140.483, 146.101, 150.861, 155.644, 160.639, 165.242, 170.605, 176.419, 180.442, 185.435, 190.824, 195.799, 200.992, 205.773, 211.098, 216.583, 221.156, 226.895, 230.96, 236.199, 241.545, 246.336, 251.149, 256.838, 261.754, 267.196, 271.366, 277.262, 281.589, 287.122, 291.878, 296.62, 301.97, 307.207, 312.031, 317.035, 321.799, 327.503)
minute <- 47
conf_level <- 0.89

reg <- lm(y~x)
pred_minute <- data.frame(x = c(minute))
predict(reg, pred_minute, interval = "confidence", level = conf_level)
```

De la salida anterior, podemos ver que los intervalos de confianza para la respuesta media Li (lwr) y Ls (upr) son:
```{r}
Li <- round(256.4348, 3)
Ls <- round(256.6896, 3)
print( c(Li, Ls) )
```

### 7. Calcular desviación estándar de los residuales.

Se tienen los siguientes datos de la velocidad **y** (en m/min) contra tiempo **x** (en min), alcanzada por un vehículo. **tiempo**: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53. **velocidad**: 17.181, 24.538, 32.33, 41.521, 48.869, 55.892, 63.898, 71.982, 80.33, 87.963, 96.125, 103.648, 111.447, 119.633, 127.088, 134.901, 143.084, 150.762, 158.753, 166.699, 174.42, 183.02, 190.631, 198.61, 206.016, 214.013, 223.339, 229.798, 237.861, 246.087, 256.157, 261.345, 269.802, 277.186, 286.323, 294.206, 302.147, 309.227, 317.644, 326.152, 333.907, 340.541, 348.266, 356.149, 364.082, 372.179, 380.07, 387.781, 395.59, 403.503, 412.34, 419.99, 427.653. Determina el valor de desviación estándar de los residuales en el modelo de regresión $y = \beta_0 + \beta_1x + \epsilon$.

Nota: aproxima UNICAMENTE hasta el final a milésimas.

#### Solución.

```{r}
x <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53)
y <- c(17.181, 24.538, 32.33, 41.521, 48.869, 55.892, 63.898, 71.982, 80.33, 87.963, 96.125, 103.648, 111.447, 119.633, 127.088, 134.901, 143.084, 150.762, 158.753, 166.699, 174.42, 183.02, 190.631, 198.61, 206.016, 214.013, 223.339, 229.798, 237.861, 246.087, 256.157, 261.345, 269.802, 277.186, 286.323, 294.206, 302.147, 309.227, 317.644, 326.152, 333.907, 340.541, 348.266, 356.149, 364.082, 372.179, 380.07, 387.781, 395.59, 403.503, 412.34, 419.99, 427.653)

reg <- lm(y~x)
summary(reg)
```

De la salida anterior podemos ver que *Residual standard error: 0.5684*, por lo que la desviación estándar de los residuales redondeada a 3 decimales es:
```{r}
round(0.5684, 3)
```

